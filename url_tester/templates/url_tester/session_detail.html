{% extends 'url_tester/base.html' %}
{% load custom_tags %}
{% block content %}

    <h2 class="text-center"><span class="badge badge-info">SESSION: {{ session.title }}</span></h2> <br/><br/>

    <div class="card">
        <div class="card-header">
            {{ session.date }}
        </div>
        <div class="card-body">
            <blockquote class="blockquote mb-0">
                <p>{{ session.description }}</p>
                <hr class="primary">
                <div class="stats">
                    {% if total_urls %}<p><small>total</small><span class="badge badge-secondary float-right">{{ total_urls }}</span></p>{% endif %}
                   {% if total_200 %} <p><small>200</small> <span class="badge badge-success float-right">{{ total_200 }}</span></p>{% endif %}
                    {% if total_301 %}<p><small>301</small> <span class="badge badge-warning float-right">{{ total_301 }}</span></p>{% endif %}
                    {% if total_302 %}<p><small>302</small> <span class="badge badge-warning float-right">{{ total_302 }}</span></p>{% endif %}
                    {% if total_404 %}<p><small>404</small> <span class="badge badge-danger float-right">{{ total_404 }}</span></p>{% endif %}
                    {% if total_500 %}<p><small>500</small> <span class="badge badge-danger float-right">{{ total_500 }}</span></p>{% endif %}
                </div>
                <footer>
                    <div class="progress">
                        <div class="progress-bar progress-bar-striped bg-{% if session.loaded %}success{% else %}danger{% endif %}"
                             role="progressbar" style="width: {% if session.loaded %}100%{% else %}1%{% endif %}"
                             aria-valuenow="25"
                             aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                </footer>
            </blockquote>
        </div>
    </div>


    <hr class="primary">

    <div class="btn-group" role="group" aria-label="Basic example">
        <a href="{% url 'sessions_list' %}" class="btn btn-secondary"><i class="fas fa-home"
                                                                         aria-hidden="true"></i> Home</a>
        <a href="{% url 'session_load' pk=session.pk %}" class="btn btn-secondary"><i class="fas fa-upload"
                                                                                      aria-hidden="true"></i>
            Load Sitemap</a>

        {#        <a href="{% url 'session_run' pk=session.pk %}" data-toggle="modal" data-target="#testModal"#}
        {#           class="btn btn-secondary">Run tests</a>#}

        <a href="{% url 'session_run' pk=session.pk %}" class="btn btn-secondary">Run tests</a>
    </div>

    <br><br>

    <div class="list-group">
        {% for url in session.urls.all %}
            <a href="{{ url.link }}" target="_blank"
               class="list-group-item list-group-item-action list-group-item-{% status_color_code url.code %}">{{ url.link }}
                {% if url.code %}
                    <span class="badge badge-secondary float-right">{{ url.code }}</span> {% endif %}
            </a>

        {% endfor %}

    </div>


    <!-- Modal -->
    <div class="modal fade" id="testModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Tests started</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    Tests are running in the background and it may take some time to complete all the tests. Please
                    check the progress bar.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

{% endblock %}